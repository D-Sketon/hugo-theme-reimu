{{- if and .Site.Params.encrypt.enable (isset .Params "encrypt") .Params.encrypt.enable -}}
{{- if .Params.encrypt.all -}}
<style>
    .encrypted-content {
        background: var(--color-wrap);
        border-radius: 10px;
        display: flow-root;
        transition: 0.3s;
        padding: 20px;
    }

    .encrypted-header {
        background: var(--red-5-5);
        border-left: 6px var(--red-4) solid;
        margin: 1.2em 0;
        border-radius: 10px;
        transition: 0.3s;
        padding: 1px 10px;
        box-shadow: var(--shadow-meta);
        padding: 15px 5px;
        text-align: center;
    }

    #encrypt-password {
        padding: 10px 16px;
        border: 2px solid var(--color-border);
        border-radius: 6px;
        font-size: 1em;
        outline: none;
        transition: border 0.2s;
        background-color: var(--color-background);
        color: var(--color-default);
    }

    #encrypt-password:focus {
        border-color: var(--red-1);
    }

    #encrypt-button {
        padding: 2px 18px;
        border: 10px var(--color-red-3-shadow) double;
        color: var(--red-2);
        font-size: 14px;
        background-color: var(--color-background);
        margin-bottom: 30px;
    }

    #encrypt-button:hover {
        border-color: var(--red-1);
        color: var(--red-1);
        font-weight: bolder;
    }

    .sliderbar-encrypt-mask {
        width: 100%;
        height: 220px;
        background: var(--red-5-5);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        border-radius: 10px;
        backdrop-filter: blur(8px);
        /* ç£¨ç ‚æ¨¡ç³Šæ•ˆæœ */
        -webkit-backdrop-filter: blur(8px);
        /* å…¼å®¹Safari */
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
    }
</style>
<script>
    let mainElement;
    let sidebarElement;
    async function encryptPassword() {
        const password = document.getElementById("encrypt-password").value;
        if (!password) {
            alert("è¯·è¾“å…¥å¯†ç ");
            return;
        }

        let article = __ENCRYPT_DATA__.article;
        let sidebar = __ENCRYPT_DATA__.sidebar;

        console.log(article)
        console.log(sidebar)
        console.log(password)

        // è§£å¯†articleå†…å®¹
        if (!article || !password) {
            throw new Error('è¯·å¡«å†™åŠ å¯†æ•°æ®å’Œå¯†ç ');
        }

        let decryptedArticle = await encrypt(article, password);

        console.log(decryptedArticle)

        // æ˜¾ç¤ºè§£å¯†ç»“æœ
        mainElement.insertAdjacentHTML("afterbegin", decryptedArticle);
        document.querySelector('.encrypted-content').remove();

        // è§£å¯†sidebarå†…å®¹
        if (!sidebar || !password) {
            throw new Error('è¯·å¡«å†™åŠ å¯†æ•°æ®å’Œå¯†ç ');
        }

        let decryptedSidebar = await encrypt(sidebar, password);

        console.log(decryptedSidebar)

        // æ˜¾ç¤ºè§£å¯†ç»“æœ
        document.querySelector(".toc-div-class").insertAdjacentHTML("afterbegin", decryptedSidebar);
        document.querySelector('.sliderbar-encrypt-mask').remove();

        // Todo é”™è¯¯å¯†ç æç¤º
        // Todo ä¿å­˜å¯†ç åˆ°æµè§ˆå™¨ç¼“å­˜
    }
    document.addEventListener("DOMContentLoaded", function () {
        // Todo å¤„ç†ç¼“å­˜å¯†ç 
        
        // æ·»åŠ æ˜¾ç¤ºåŠ å¯†éƒ¨åˆ†å ä½å…ƒç´ 
        let enctyptedArcitleElement = `
        <div class="encrypted-content aos-init aos-animate">
            <div class="encrypted-header">
                ğŸ” å†…å®¹å·²éšè—ï¼Œè¾“å…¥å¯†ç åæŸ¥çœ‹
            </div>
            <div style="text-align:center; margin-top:18px;">
                <input type="password" id="encrypt-password" placeholder="è¯·è¾“å…¥å¯†ç " />
                <button type="button" id="encrypt-button" onclick="encryptPassword()">è§£é”</button>
            </div>
        </div>
        `;
        let enctyptedSidebarElement = `
        <div class="sliderbar-encrypt-mask">
            ğŸ”
        </div>
        `;
        mainElement = document.querySelector("#main");
        if (mainElement) {
            mainElement.insertAdjacentHTML("afterbegin", enctyptedArcitleElement);
        }
        let sidebarElements = document.querySelectorAll(".toc-div-class");
        sldebarElement = sidebarElements[0];
        let sidebarElementMobie = sidebarElements[1];

        if (sldebarElement) {
            sldebarElement.insertAdjacentHTML("afterbegin", enctyptedSidebarElement);
        }
    });
</script>
{{- else -}}
<script>
    // Todo æ–‡ç« å±€éƒ¨å†…å®¹åŠ å¯†
    console.log("Hello, Partial");
</script>
{{- end -}}
{{- end -}}